```{r}
set.seed(25)

fls.muestra.setosa=sample(1:50, replace = TRUE)
fls.muestra.versicolor=sample(51:100, 4, replace = TRUE)
fls.muestra.virginica=sample(101:150,4, replace = TRUE)



```

```{r}
(muestra.iris.estratificada=rbind(iris[fls.muestra.setosa,], iris[fls.muestra.versicolor,], iris[fls.muestra.virginica,]))

```

```{r}
muestra.iris.estratificada
```

```{r}

##Muestra por conglomerado##

library(faraway)
```

```{r}
head(worldcup)
```

Suponga que quiere calcular una muestra por tama√±o indeterminado de los jugadores por conglomerados eligiendo como conglomerados los paises a los que perteneces

Primero, averiguemos cuantos paises hay. 

```{r}
set.seed(19)
unique(worldcup$Team)
```

En total hay 32 paises.

Ahora, si quiero hacer un analissi de conglomerado de una muestra de 4 paises, y la muestra son todos los jugadores pertenecientes a dicho pais. 

```{r}
set.seed(19)
numero.paises.elegidos = sample(1:32,4, replace=FALSE)
paises.elegidos = unique(worldcup$Team)[numero.paises.elegidos]

paises.elegidos
```

Ahora, seleccionemos la muestra conglomerada.

```{r}
muestra.worldcup.conglomerada = worldcup[worldcup$Team%in%paises.elegidos,]

muestra.worldcup.conglomerada
```

Dicha muestra solo tiene 71 registros.
```{r}
head(muestra.worldcup.conglomerada, 8)
```

##MUESTREO POLIETAPICO##
Si tomo de un muestreo conglomerado, de cada uno de estos conglomerados una miuestra aleatoria, entonces a esto de le llama un muestreo poletapico. 

Para un eje plo, del analisis de conglomerados anterior, de los 4 paises seleccionados, voy a elegir 5 jugadores. Para ello: 

```{r}
#Seleccionamos4 tablas, cada unoa de cada pais elegido#
worldcup.pais1 = worldcup[worldcup$Team==paises.elegidos[1],]
worldcup.pais2 = worldcup[worldcup$Team==paises.elegidos[2],]
worldcup.pais3 = worldcup[worldcup$Team== paises.elegidos[3],]
worldcup.pais4 = worldcup[worldcup$Team== paises.elegidos[4],]
```

ahora, seleccionamos 5 jugadores de los 4 paises elegidos. 

```{r}
jugadores.pais1= sample(1:dim(worldcup.pais1)[1], 5, replace = FALSE)
jugadores.pais2= sample(1:dim(worldcup.pais2)[1],5, replace = FALSE)
jugadores.pais3= sample(1:dim(worldcup.pais3)[1],5, replace = FALSE)
jugadores.pais4= sample(1:dim(worldcup.pais4)[1],5, replace = FALSE)
```

Por ultimo, se une dichas filas creadas en una unica tabla.

```{r}
muestra.worldcup.polietapica = rbind(worldcup.pais1[jugadores.pais1,],
                                     worldcup.pais2[jugadores.pais2,],
                                     worldcup.pais3[jugadores.pais3,],
                                     worldcup.pais4[jugadores.pais4,])

muestra.worldcup.polietapica

```


