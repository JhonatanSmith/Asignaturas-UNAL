---
title: "Parcial 3 Muestreo"
author: "Jhonatan Smith Garcia"
date: "24/8/2021"
output: pdf_document
---

# Muestreo por conglomerados:

*Estimacion de media*

Promedio por conglomerado (cantidad por canasta):

```{r}

ti = c(5892,5991,5969,5935,5960,5909) # total vble examinado 
# en el i-esima unidad del conglomerado. Se suman las cantidades totales del conglomerado, aki, conglomerado 1 al 6

n = 6 # Muestra

y_c = sum(ti/n) # Promedio por conglomerado es este
y_c
```
Promedio por unidad de cada conglomerado (Cantidad por botella)

```{r}

M = 6 # Numero de conglomerados que tengo

y_bar = y_c/M # Promedio por cd unidad de conglomerado
y_bar
```
*Estimacion total estimado:*

El total estimado para el total de conglomerado (todas las canastas)

```{r}

N = 40 # Las 40 canastas osea, cantidad total poblacional

t_c = N*y_c 
t_c

```
# Calculo de varianzas por conglomerados:

*Varianza total por conglomerado:*

```{r}

N = 40 # Numero total de unidades conglomerado (40 canastas)

n = 6 # tama単o de la muestra

ti = c(5892,5991,5969,5935,5960,5909) #Se suman las cantidades totales del conglomerado, aki, conglomerado 1 al 6

y_c = sum(ti/n) # Promedio por conglomerado es este. Promedio por canasta

var_tc = N*(N-n)/n*sum((ti-y_c)^2)/(n-1)
var_tc
```
ahora, el error estimado es:

```{r}
ee = sqrt(var_tc)
ee
```
*varianza media por conglomerado:*

```{r}

M0 = 240 # N*M numero de elementos unitarios en los conglomerados. N es cantidad de conglomerados, 40 cajas y N es el numero de unidades por conglomeradao, 6 botellas

var_mu = 1/(M0)^2*var_tc

var_mu
```
el error estimado para la media por conlgomerado es:

```{r}
ee = sqrt(var_mu)
ee
```

# Tama単o muestra por conglomerados:

El tama単o de muestra para estimar a mu esta dado por

```{r}

M = 6 # Numero de unidades elementales (las botellas en cd caja)
B = 2 # Error, me lo da ejercico
D = B^2*M^2/4

N= 2000 # Poblacion total 
s2h_c = 1417.87 # varianza en el i-esimo conglomerado. Se debe calcular de la muestra con var

n = (N*s2h_c)/(N*D+s2h_c)
n


```


Tama単o muestra para aproximar a total:

```{r}
N = # Numero de conglomerados
D = B^2/(4*N^2)
n = (N*s2h_c)/(N*D+s2h_c)

```


# Proporcion por conglomerado:

```{r}

Ai = c(36,32,28,38,33,31,35,39,27,34,31,32,37,38,33,32,30,28,30,36,31,32,34,34,36,29,40,35,36,24,33,32,33,37,25,29,36,31,38,37)# Elementos i-esimo congl que cumplen condicion

M = 40 # Unidades elementales (40 casas por bloque/manzana)
N = 40 # Conglomerados (40 bloques/manzanas)
n=5  

M0 = N*M

Pi = sum(Ai/M)/(N) # Proporcion poblacional

ph_c = c(38,32,35,33,25)/40

p_c = (1/n)*sum(ph_c)
p_c # Valor proporcion por estrato 
```

Varianza de la proporcion:

```{r}

var_pcon = (N-n)/(n*N)*sum((Pi-p_c)^2/(n-1))
var_pcon

```


# Total elementos con caracteristica A:

```{r}

A_c = N*p_c

```

Varianza de esto es

```{r}
var_ac = N^2*var_pcon

```



```{r}
calculoS2i <- function(lista,mui){
  s2i <- numeric(length(peo))
  for (i in 1:length(peo)) {
    x <- sum((peo[[i]]-mui[c(i)])^2/(mi-1))
    s2i[i] <- x
  }
  s2i
}

mi=4
manzana13=c(293,222,340,353)
manzana19=c(301,312,244,259)
manzana34=c(264,164,259,192)
manzana32=c(342,264,251,251)
manzana21=c(185,216,144,216)
manzana27=c(187,280,334,218)
yi=c(sum(manzana13),sum(manzana19),sum(manzana34),
     sum(manzana32),sum(manzana21),sum(manzana27))
mui=1/mi*yi

peo=list(manzana13,manzana19,manzana21,manzana27,manzana32,manzana34)

# El ejemplo
tercerpeo=calculoS2i(peo,mui)
tercerpeo
```














