---
title: "Formulas MAP"
author: "Jhonatan Smith Garcia"
date: "20/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1) Media poblacional Post Estratificada

$\bar{y}_{post}=\frac{1}{N}\sum_{h=1}^HN_h*\bar{y}_h=\sum_{h=1}^HW_h*\bar{y}_h$ 

```{r}

Nh = c() # Vector coordenadas total poblacion
yh = c() # vector coordenadas medias 
N = sum(Nh)
y_bar_post = 1/N*sum(Nh*yh)

```

*La varianza de y-barra post estratificado es:*

```{r}
s2h = c() # Varianzas muestrales 

A = (N-n)/(N^2*n)*sum(Nh*s2h)
B = (1/n^2)*(N-n)/(N-1)*sum(1-(Nh)/(N)*s2h)

varianza_y_bar_post = A*B
```



#2) Total Post Estratificado

$\hat{\tau}_{post}=N*\bar{y}_h$ y su varianza es

$Var[\hat{\tau}_{post}]=N^2*Var[\bar{y}_{post}]$

```{r}

total_post = N*y_bar_post
varianza_total_post = N^2*varianza_y_bar_post

```

# 3) Identificacion numero de estratos:

Para identificar el numero de estratos correspondientes se hace uso de la tabla de frecuencias y frecuencias relatvias.

son 4 columnas, de esta manera:

Dato  ---  frecuencia --- sqrt(frecuencia) --- sum(sqrt(freqn))

0-50  ---   16        --- 7.071            ---  7.071

Y asi, se van acumulando y sumando.

# 4) Muestreo Doble

Primera fase:

```{r}
nh_prima = c() # Muestra del estrato h-esimo

n_prima = c() # Tamaño muestra fase 1

wh_prima= nh_prima/n_prima #De la primera muestra; proporion que pertenecen al estrato H.


```

Segunda fase:

Las mediciones se tienen a partir de estos segundos elementos.

```{r}
nh = c() # Elementos muestreados de nh_prima y que pertencen al estrato h

yh = c() # Vector con medias muestrales de cd estrato en sdo muestreo

```

*Media poblacional para doble estratificacion*

```{r}

y_bar_mdest = sum(wh_prima*yh) #Media poblacional doble estratificacion

```



*Varianza de Y-barra muestreo doble*

Considerando las fracciones de muestreo son pequeñas (nh/N) entonces

```{r}
var_y_bar_mdest = (n_prima/(n_prima-1))*sum(((wh_prima)^2 - wh_prima/n_prima)*s2h/nh+(wh_prima*(yh-y_bar_mdest)^2)/(n_prima))

```

considerando a *n_prima* grande tal que wh_prima/n_prima es despreciable entonces

```{r}

var_y_bar_mdest = sum(wh_prima^2*s2h/nh)+sum((wh_prima*(yh-y_bar_mdest)^2)/n_prima)


```


