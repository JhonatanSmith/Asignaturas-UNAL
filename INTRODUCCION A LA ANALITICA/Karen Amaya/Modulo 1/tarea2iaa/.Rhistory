algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),  fill = c('black','red') )
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 7000,y = 5000, legend = c("Observado", "Predicho"),  fill = c('black','red') )
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 5000,y = 7000, legend = c("Observado", "Predicho"),  fill = c('black','red') )
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),cex = 1.1,  fill = c('black','red') )
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),
cex = 0.6, horiz = TRUE,  fill = c('black','red'),bty = "n" )
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),
cex = 0.6, horiz = TRUE,  fill = c('black','red'),bty = "n" ,
border="#000000",)
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),
cex = 0.6, horiz = TRUE,  fill = c('black','red'),bty = "n" ,
border="#000000",lwd=6)
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),
cex = 0.6, horiz = TRUE,  col = c('black','red'),bty = "n" ,
border="#000000")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),
cex = 0.6,  col = c('black','red'),bty = "n" ,
border="#000000")
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),
cex = 0.6,  col = c('black','red'),bty = "n" ,
border="#000000")
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'bottomright', legend = c("Observado", "Predicho"),
cex = 0.6, horiz = TRUE,  fill = c('black','red'),
border="#000000",lwd=6)
leg.txt <- c("a one", "a two")
par(mfrow = c(2, 2))
for(ll in c("","x","y","xy")) {
plot(2:10, log = ll, main = paste0("log = '", ll, "'"))
abline(1, 1)
lines(2:3, 3:4, col = 2)
points(2, 2, col = 3)
rect(2, 3, 3, 2, col = 4)
text(c(3,3), 2:3, c("rect(2,3,3,2, col=4)",
"text(c(3,3),2:3,\"c(rect(...)\")"), adj = c(0, 0.3))
legend(list(x = 2,y = 8), legend = leg.txt, col = 2:3, pch = 1:2,
lty = 1, merge = TRUE)   #, trace = TRUE)
}
par(mfrow = c(1,1))
#5
matrix(c(5,-10,0,-10,25,0,0,0,10),ncol = 3, byrow = T)
#5
v<-matrix(c(5,-10,0,-10,25,0,0,0,10),ncol = 3, byrow = T)
v*4
v*(-1)
set.seed(123)
x=runif(30,-300,300)
y=runif(30,-300,300)
plot(x,y,ylab="Variable 1",xlab="Variable2",
ylim=c(-500,500),xlim=c(-500,500),col=c("red","blue"))
legend(x=380,y=495,legend=c("Nivel1","Nivel2"),
fill=c("red","blue"),cex=0.4,text.font=4, bg='grey')
data <- read.csv("costumer_loan_details.csv")
n = nrow(data)
train_ind = sample(1:n, size = round(0.75*n), replace=FALSE)
train = data[train_ind,]
test = data[-train_ind,]
##==================================================
x_train <-data.frame('debts' = as.data.frame(train[,'debts']))
y_train <-data.frame('income' = as.data.frame(train[,"income"]))
y_test <- test[,'income']
###########
data2<- data.frame('debts' = x_train, 'income'= y_train)
colnames(data2) <- c('debts','income' )
library(FNN)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x=380,y=495,legend=c("Nivel1","Nivel2"),
fill=c("red","blue"),cex=0.4,text.font=4, bg='grey')
legend(x=380,y=495,legend=c("Nivel1","Nivel2"),
fill=c("red","blue"),cex=0.4,text.font=4, bg='grey')
legend(x=6000,y=2000,legend=c("Nivel1","Nivel2"),
fill=c("red","blue"),cex=0.4,text.font=4, bg='grey')
legend(x=6000,y=2000,legend=c("Nivel1","Nivel2"),
fill=c("red","blue"),cex=1,text.font=4, bg='grey')
legend(x = "topright", legend = c("No", "Yes"), fill = c("royalblue", "grey"),
title = "Loan")
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, horiz = TRUE, border="#000000",lwd=6)
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000")
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
par(mfrow=c(2,2))
xyplot(data2$debts, data2$income, groups=c('f','m'), panel =
panel.superpose, type=c('’p’','’smooth’'),
span=.75, auto.key=T)
#plot1
par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000", )
#plot1
#par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=4")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000", )
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000",fill = c('black','red') )
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =8,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
#par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=8")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000",fill = c('black','red') )
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =12,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
#par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=12")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000",fill = c('black','red') )
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =16,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
#par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=12")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000",fill = c('black','red') )
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =16,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
#plot1
#par(mfrow=c(2,2))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts",main = "Knn con K=16")
points(data2$debts,ypred_knn,pch=1,col="red")
legend(x = 'topright', legend = c("Observado", "Predicho"),
cex = 0.6, border="#000000",fill = c('black','red') )
seq(4:16,4)
seq(4,16,4)
k[1]
k<- list(seq(4,16,4))
k[1]
k[[1]]
ypred_knn<- []
k<- list(seq(4,16,4))
ypred_knn<- list()
for (i in k){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = i,
algorithm=c("brute"))
ypred_knn[i] <- fit.knn$pred
}
k<- seq(4,16,4)
k[1]
k<- seq(4,16,4)
ypred_knn<- list()
for (i in k){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = i,
algorithm=c("brute"))
ypred_knn[i] <- fit.knn$pred
}
ypred_knn
k<- seq(4,16,4)
ypred_knn<- list()
for (i in k){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = i,
algorithm=c("brute"))
ypred_knn[i-4] <- fit.knn$pred
}
ypred_knn
k<- seq(4,16,4)
ypred_knn<- list()
for (i in k){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = i,
algorithm=c("brute"))
ypred_knn[i-3] <- fit.knn$pred
}
ypred_knn
ypred_knn<- list()
for (i in 1:4){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = 4*i,
algorithm=c("brute"))
ypred_knn[i-3] <- fit.knn$pred
}
ypred_knn
ypred_knn<- list()
for (i in 1:4){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = 4*i,
algorithm=c("brute"))
ypred_knn[i] <- fit.knn$pred
}
ypred_knn
fit.knn$pred
ypred_knn[1]
fit.knn$pred
ypred_knn<- array()
for (i in 1:4){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = 4*i,
algorithm=c("brute"))
ypred_knn[i] <- fit.knn$pred
}
ypred_knn[1]
#--------------------------------------------------
x_test <- as.data.frame(test[,'debts'])
library(FNN)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =8,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =8,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =12,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =12,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =16,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =16,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
mod <- lm(income ~ debts, data = data2)
ypred <- mod$fitted.values
plot(data2$debts,data2$income,col="black", ylab = "income",xlab = "debts")
points(data2$debts,ypred,pch=1,col="red")
legend(x = 'bottomright', legend = c("original", "predicción"),  fill = c('black','red') )
#--------------------------------------------------
x_test <- as.data.frame(test[,'debts'])
colnames(x_test)<- 'debts'
test_pred <-predict(mod, newdata = x_test)
test_pred %>% head
length(test_pred)
#MSE MODELO LM
mean((y_test-test_pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =4,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =8,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =8,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =12,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =12,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k =16,
algorithm=c("brute"))
ypred_knn <- fit.knn$pred
fit2.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(x_test) ,
as.data.frame(data2$income),k =16,
algorithm=c("brute"))
#MSE MODELO KNN
mean((y_test - fit2.knn$pred)^2)
data <- read.csv("costumer_loan_details.csv")
n = nrow(data)
train_ind = sample(1:n, size = round(0.75*n), replace=FALSE)
train = data[train_ind,]
test = data[-train_ind,]
##==================================================
x_train <-data.frame('debts' = as.data.frame(train[,'debts']))
y_train <-data.frame('income' = as.data.frame(train[,"income"]))
y_test <- test[,'income']
###########
data2<- data.frame('debts' = x_train, 'income'= y_train)
colnames(data2) <- c('debts','income' )
mod <- lm(income ~ debts, data = data2)
ypred <- mod$fitted.values
plot(data2$debts,data2$income,col="black", ylab = "income",xlab = "debts")
points(data2$debts,ypred,pch=1,col="red")
legend(x = 'bottomright', legend = c("original", "predicción"),  fill = c('black','red') )
#--------------------------------------------------
x_test <- as.data.frame(test[,'debts'])
colnames(x_test)<- 'debts'
test_pred <-predict(mod, newdata = x_test)
test_pred %>% head
length(test_pred)
#MSE MODELO LM
mean((y_test-test_pred)^2)
#--------------------------------------------------
x_test <- as.data.frame(test[,'debts'])
colnames(x_test)<- 'debts'
test_pred <-predict(mod, newdata = x_test)
test_pred %>% head
length(test_pred)
#MSE MODELO LM
mean((y_test-test_pred)^2)
mod <- lm(income ~ debts, data = data2)
ypred <- mod$fitted.values
plot(data2$debts,data2$income,col="black", ylab = "income",xlab = "debts")
points(data2$debts,ypred,pch=1,col="red")
legend(x = 'bottomright', legend = c("original", "predicción"),  fill = c('black','red') )
#--------------------------------------------------
x_test <- as.data.frame(test[,'debts'])
colnames(x_test)<- 'debts'
test_pred <-predict(mod, newdata = x_test)
test_pred %>% head
length(test_pred)
#MSE MODELO LM
mean((y_test-test_pred)^2)
par(mfrow=c(2,2))
for (i in 1:4){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = 4*i,
algorithm=c("brute"))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts")
points(data2$debts,ypred_knn,pch=1,col="red")
}
data <- read.csv("costumer_loan_details.csv")
n = nrow(data)
train_ind = sample(1:n, size = round(0.75*n), replace=FALSE)
train = data[train_ind,]
test = data[-train_ind,]
##==================================================
x_train <-data.frame('debts' = as.data.frame(train[,'debts']))
y_train <-data.frame('income' = as.data.frame(train[,"income"]))
y_test <- test[,'income']
###########
data2<- data.frame('debts' = x_train, 'income'= y_train)
colnames(data2) <- c('debts','income' )
library(FNN)
par(mfrow=c(2,2))
for (i in 1:4){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = 4*i,
algorithm=c("brute"))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts")
points(data2$debts,ypred_knn,pch=1,col="red")
}
par(mfrow=c(2,2))
for (i in 1:4){
fit.knn <- knn.reg(train = as.data.frame(data2$debts) ,
test = as.data.frame(data2$debts) ,
as.data.frame(data2$income),k = 4*i,
algorithm=c("brute"))
plot(data2$debts, data2$income, col="black", ylab = "income",
xlab = "debts")
points(data2$debts,fit.knn$pred,pch=1,col="red")
}
mod <- lm(income ~ debts, data = data2)
ypred <- mod$fitted.values
plot(data2$debts,data2$income,col="black", ylab = "income",xlab = "debts")
points(data2$debts,ypred,pch=1,col="red")
legend(x = 'bottomright', legend = c("original", "predicción"),  fill = c('black','red') )
summary(mod)
