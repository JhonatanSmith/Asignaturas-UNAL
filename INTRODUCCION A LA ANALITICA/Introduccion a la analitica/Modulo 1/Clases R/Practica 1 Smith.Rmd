---
title: "Ejemplos clase 4"
author: "Jhonatan Smith Garcia"
date: "13/10/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Primer ejercicio

1) Se lee la base de datos

```{r}
library(e1071) # Libreria que tiene naive bayes

names = read.csv(file.choose(),stringsAsFactors = TRUE, sep = ";") # Seleccione la base datos "names"
```

el problma pide que, dado unos datos, escoja la probabilidad de que el siguiente morgan sea hombre o mujer

```{r}
names
```

2) Se aplicará el clasificador de naive bayes

```{r}
clasificador = naiveBayes(SEX~NAME, data = names) # La primera parte de SEX~NAME es la regresion ajustada

summary(clasificador)
```

3) Llegada nuevo sujeto llamado morgan

```{r}
datos_prueba = data.frame(NAME=c("MORGAN"))

prediccion_nombre = predict(clasificador,datos_prueba,type = "raw")

prediccion_nombre

```
Aqui se predice la probabilidad del genero de ese nombre segun los datos que se generaron. 

4) Estimacion final 

```{r}
sex_predict = predict(clasificador,datos_prueba,type = "class")
sex_predict
```
Aqui selecciona directamente cual será la respuesta a secas. Es hombre

# Ejercicio 2

1) se monta los datos

```{r}
defaulted = read.csv(file.choose(),stringsAsFactors = FALSE, sep = ";")
```

```{r}
defaulted
```


2) Seleccion datos de entrenamiento 

```{r}
train = data.frame(defaulted[1:10,]) #Entrenamiento
test = data.frame(defaulted[11:11,1:4]) # nuevo dato
```

Tengo 10 datos y llegaun nuevo dato para realizar una nueva prediccion

3) Vamos a crear el clasificador para el problema:

Recuerde la naturaleza del problema:

se tiene una base de datos con las variables c(Home_owner, marital_status, job_experience, defaulted)

que representa la idea de que, dado un sujeto al que le conoce ciertas caracteristicas, asignele una respuesta(digamos, habilitar o no un prestamo, por ejemplo)

 *El clasificador*
 
```{r}

#Clasificador para base defaulted
defaulted_classifier = naiveBayes(Defaulted~Home_Owner+marital_Status+Job_Experience, data = train, laplace = 0.128)

```

3) Predictor segun clasificador
 
```{r}
defaulted_predict = predict(defaulted_classifier, test, type = "raw")
defaulted_predict
```


# K vecinos mas cercanos

```{r}
crocodile = read.csv(file.choose(),sep = ";", header = TRUE, dec = ",")
```


```{r}
df = crocodile
x_train = normilize(df[,2:3]) # Normaliza las X continuas
y_train = crocodile[,4] # Selecciona la Y categorica de respuesta
fit.knn_train = knn(train=x_train,test = x_train,cl =y_train, k=12, prob = TRUE)
Test = normilize(data.frame(Mouth_Size=c(9,1.2,10,1,1.1), Body_Length=c(7.9,3.7,8,2,2.3)))
fit.knn_test = knn(train = x_train, test = Test,cl = y_train,k=12, prob = TRUE)
predicted = factor(fit.knn_test)
prob = attr(fit.knn_test,"prob")
Cprob = 1-prob
Type = c("1=C", "2=L")
Type
class_prob = cbind(predicted,prob,Cprob)
class_prob
```





