position = 'identity',
alpha = 0.2) +
labs(title = 'Histogramas cruzados por genero',
fill = 'Genero',
x = 'Edad(dias)',
y = 'EDAD')
#Library(ggplot2)
# haciendo más cosas interesantes
ggplot(data = datos,
mapping = aes(x = EDAD,
fill = factor(GENERO))) +
geom_histogram(bins = 4,
position = 'identity',
alpha = 0.2) +
labs(title = 'Histogramas cruzados por genero',
fill = 'Genero',
x = 'Edad(dias)',
y = 'EDAD')
#Library(ggplot2)
# haciendo más cosas interesantes
ggplot(data = datos,
mapping = aes(x = EDAD,
fill = factor(GENERO))) +
geom_histogram(bins = 9,
position = 'identity',
alpha = 0.2) +
labs(title = 'Histogramas cruzados por genero',
fill = 'Genero',
x = 'Edad(dias)',
y = 'EDAD')
#Library(ggplot2)
# haciendo más cosas interesantes
ggplot(data = datos,
mapping = aes(x = EDAD,
fill = factor(GENERO))) +
geom_histogram(bins = 9,
position = 'identity',
alpha = 0.5) +
labs(title = 'Histogramas cruzados por genero',
fill = 'Genero',
x = 'Edad(dias)',
y = 'EDAD')
ggplot(datos, aes(x=EDAD)) +
geom_freqpoly(bins=20, aes(color=GENERO)) +
labs(color="Género")
library(haven)
library(ggplot2)
g2 <- ggplot(datos, aes(GENERO, EDAD))
g2 + geom_boxplot(aes(fill = GENERO))
table(GENERO,TIPO_COLE)
40/59
38/41
knitr::opts_chunk$set(echo = TRUE)
a = table(TIPO_COLE)
b= prop.table(a)
b
barplot(b, ylab = "Porcentaje")
# Tapply aplica la fn especificada y divide los datos por la categoria INDEX
tapply(EDAD, INDEX = GENERO, FUN = mean)
#Library(ggplot2)
# haciendo más cosas interesantes
ggplot(data = datos,
mapping = aes(x = EDAD,
fill = factor(GENERO))) +
geom_histogram(bins = 9,
position = 'identity',
alpha = 0.5) +
labs(title = 'Histogramas cruzados por genero',
fill = 'Genero',
x = 'Edad(dias)',
y = 'EDAD')
# Tapply aplica la fn especificada y divide los datos por la categoria INDEX
tapply(LONG_PIE, INDEX = GENERO, FUN = mean)
table(GENERO,TIPO_COLE)
25.29915-22.79878
?rm
rm(list=ls(all=TRUE))
datos4=data.frame(Temperatura=factor(rep(c("baja","alta"),times=10)),encogimiento=scan())
attach(datos4)
medias=sapply(split(encogimiento,Temperatura),mean)
medias
mean(encogimiento) #promedio global
vari=sapply(split(encogimiento,Temperatura),var); vari
boxplot(encogimiento~Temperatura,boxwex=0.5)
View(datos4)
rep(c("baja","alta"),times=10)
attach(datos4)
?sapply
split(encogimiento,Temperatura)
medias
mean(encogimiento) #promedio global
vari=sapply(split(encogimiento,Temperatura),var); vari
var.test(encogimiento~Temperatura,alternative="two.sided")
?var.test
?t.test
t.test(encogimiento~Temperatura,var.equal=TRUE,alternative="two.sided",
paired=FALSE)
modeloanova=aov(encogimiento~Temperatura) # Use esa fn y le saca summary
summary(modeloanova)
8.82/18
library(lsmeans)
install.packages("lsmeans")
library(lsmeans)
lsmeans(modeloanova,~Temperatura)
?lsmeans
install.packages("gmodels")
mrlm1=lm(encogimiento~-1+Temperatura)
summary(mrlm1)
mrlm1
mrlm1=lm(encogimiento~-1+Temperatura)
summary(mrlm1)
confint(mrlm1)
> library(car)
library(car)
linearHypothesis(mrlm1,c("Temperaturaalta-Temperaturabaja=0"))
2     18  8.820  1    57.122 116.58 2.71e-09 *** # Se rechaza H0 a favor de H1
# Soluci ´on mediante modelo de regresi ´on con efectos de tratamientos:
#Asume la igualdad de varianzas
I1=ifelse(Temperatura=="alta",1,0); I2=ifelse(Temperatura=="baja",1,0)
X=I1-I2 #desde que n_1=n_2
mrlm2=lm(encogimiento~X); summary(mrlm2)
I1
X
mrlm2=lm(encogimiento~X); summary(mrlm2)
summary(mrlm2)
summary(mrlm2)
linearHypothesis(mrlm1,c("Temperaturaalta-Temperaturabaja=0"))
Model 2: encogimiento ~ -1 + Temperatura # Se quita intercepto y se usa indicadoras
?rm
rm(list=ls(all=TRUE))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
datos9=data.frame(Técnico=factor(rep(c(1,2),each=8)),muestra=factor(rep(1:8,times=2)),
Pureza=scan())
74.0 73.1 73.5 73.9 71.2 72.5 73.0 74.3
rm(list=ls(all=TRUE))
datos9=data.frame(Técnico=factor(rep(c(1,2),each=8)),muestra=factor(rep(1:8,times=2)),
Pureza=scan())
View(datos9)
?rep
rep(c(1,2))
rep(c(1,2), each=8)
View(datos9)
medias=sapply(split(Pureza,Técnico),mean) #Medias medidas según técnico
View(datos9)
medias=sapply(split(Pureza,Técnico),mean) #Medias medidas según técnico
rm(list=ls(all=TRUE))
datos9= data.frame(Técnico=factor(rep(c(1,2),each=8)),muestra=factor(rep(1:8,times=2)),
Pureza=scan())
74.0 73.1 73.5 73.9 71.2 72.5 73.0 74.3
attach(datos9)
medias=sapply(split(Pureza,Técnico),mean) #Medias medidas según técnico
medias
medias2=sapply(split(Pureza,muestra),mean)#Medias medidas en cada muestra
medias2
difer=Pureza[Técnico==1]-Pureza[Técnico==2] #diferencias entre pares de observaciones
mean(difer) #media muestral diferencias entre pares de observaciones
var(difer) #Varianza muestral diferencias entre pares de observaciones
Pureza[Técnico==1]
#Gráficos descriptivo
plot(as.numeric(muestra),Pureza,col=as.numeric(Técnico),pch=as.numeric(Técnico),
xlab="muestra",cex=1.5,ylim=c(70,75))
lines(1:8,medias2,type="b",pch=19,lty=2,col=4)
segments(1:8,Pureza[Técnico==1],1:8,Pureza[Técnico==2])
legend("topleft",legend=c("Técnico 1","Técnico 2","Media medidas pureza por pieza"),
pch=c(1:2,19),col=c(1:2,4),bg="cornsilk")
boxplot(difer,boxwex=0.5,ylab="Diferencias por pares") #Distribución de las diferencias
#pareadas
abline(h=0,lty=3,col=2)
#Gráficos descriptivo
plot(as.numeric(muestra),Pureza,col=as.numeric(Técnico),pch=as.numeric(Técnico),
xlab="muestra",cex=1.5,ylim=c(70,75))
lines(1:8,medias2,type="b",pch=19,lty=2,col=4)
segments(1:8,Pureza[Técnico==1],1:8,Pureza[Técnico==2])
legend("topleft",legend=c("Técnico 1","Técnico 2","Media medidas pureza por pieza"),
pch=c(1:2,19),col=c(1:2,4),bg="cornsilk")
boxplot(difer,boxwex=0.5,ylab="Diferencias por pares") #Distribución de las diferencias
#pareadas
abline(h=0,lty=3,col=2)
t.test(Pureza~Técnico,var.equal=TRUE,alternative="two.sided",paired=TRUE)
modeloanova = aov(Pureza ~Técnico+muestra)
# Primero se crea el modelo
modeloanova = aov(Pureza ~Técnico+muestra)
# Luego, se saca la tabla anova
anova(modeloanova)
#INDICADORAS
I1=ifelse(Técnico=="1",1,0); I2=ifelse(Técnico=="2",1,0); Z1=ifelse(muestra=="1",1,0); Z2=ifelse(muestra=="2",1,0)
Z3=ifelse(muestra=="3",1,0); Z4=ifelse(muestra=="4",1,0); Z5=ifelse(muestra=="5",1,0); Z6=ifelse(muestra=="6",1,0)
Z7=ifelse(muestra=="7",1,0); Z8=ifelse(muestra=="8",1,0)
#VARIABLES EXPLICATORIAS PARA EL AJUSTE POR REGRESIÓN
X=I1-I2; W1=Z1-Z8; W2=Z2-Z8; W3=Z3-Z8; W4=Z4-Z8; W5=Z5-Z8; W6=Z6-Z8; W7=Z7-Z8
mrlm=lm(Pureza~X+W1+W2+W3+W4+W5+W6+W7); summary(mrlm)
#VARIABLES EXPLICATORIAS PARA EL AJUSTE POR REGRESIÓN
X=I1-I2; W1=Z1-Z8; W2=Z2-Z8; W3=Z3-Z8; W4=Z4-Z8; W5=Z5-Z8; W6=Z6-Z8; W7=Z7-Z8
mrlm=lm(Pureza~X+W1+W2+W3+W4+W5+W6+W7)
# Finalmente, un resumen del modelo
summary(mrlm)
library(car) # Se llama esta libreria
linearHypothesis(mrlm,"X=0") # modelo es ese y vble explicatoria vale 0
#GRÁFICO DE RESIDUOS ESTUDENTIZADOS INTERNAMENTE
win.graph(width=8.5,height=6)
layout(rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6)))
plot(fitted(modeloanova),rstandard(modeloanova),main="residuos estudentizados vs. ajustados\nModelo ANOVA",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~Técnico, main="residuos estudentizados vs. Técnico\nModelo ANOVA",
xlab="Técnico",vertical=T, ylim=c(-2.5,2.5),pch=1:2,col=c(1:2),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~muestra,main="residuos estudentizados vs. muestra\nModelo ANOVA",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(fitted(mrlm),rstandard(mrlm),main="residuos estudentizados vs. ajustados\nMRLM",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(X,rstandard(mrlm),xlab="X",main="residuos estudentizados vs. X\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5), pch=as.numeric(Técnico),col=as.numeric(Técnico),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
legend("top",legend=c(expression(paste("Técnico 1",sep=" ","(",sep="",X==+1,sep="",")")),
expression(paste("Técnico 2",sep=" ","(",sep="",X==-1,sep="",")"))),
pch=1:2,col=1:2,bg="cornsilk")
stripchart(rstandard(mrlm)~muestra,main="residuos estudentizados vs. muestra\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5),xlab="muestra",ver
#GRÁFICO DE RESIDUOS ESTUDENTIZADOS INTERNAMENTE
win.graph(width=8.5,height=6)
layout(rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6)))
plot(fitted(modeloanova),rstandard(modeloanova),main="residuos estudentizados vs. ajustados\nModelo ANOVA",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~Técnico, main="residuos estudentizados vs. Técnico\nModelo ANOVA",
xlab="Técnico",vertical=T, ylim=c(-2.5,2.5),pch=1:2,col=c(1:2),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~muestra,main="residuos estudentizados vs. muestra\nModelo ANOVA",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(fitted(mrlm),rstandard(mrlm),main="residuos estudentizados vs. ajustados\nMRLM",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(X,rstandard(mrlm),xlab="X",main="residuos estudentizados vs. X\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5), pch=as.numeric(Técnico),col=as.numeric(Técnico),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
legend("top",legend=c(expression(paste("Técnico 1",sep=" ","(",sep="",X==+1,sep="",")")),
expression(paste("Técnico 2",sep=" ","(",sep="",X==-1,sep="",")"))),
pch=1:2,col=1:2,bg="cornsilk")
stripchart(rstandard(mrlm)~muestra,main="residuos estudentizados vs. muestra\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5),xlab="muestra",ver
#GRÁFICO DE RESIDUOS ESTUDENTIZADOS INTERNAMENTE
win.graph(width=8.5,height=6)
layout(rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6)))
plot(fitted(modeloanova),rstandard(modeloanova),main="residuos estudentizados vs. ajustados\nModelo ANOVA",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~Técnico, main="residuos estudentizados vs. Técnico\nModelo ANOVA",
xlab="Técnico",vertical=T, ylim=c(-2.5,2.5),pch=1:2,col=c(1:2),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~muestra,main="residuos estudentizados vs. muestra\nModelo ANOVA",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(fitted(mrlm),rstandard(mrlm),main="residuos estudentizados vs. ajustados\nMRLM",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(X,rstandard(mrlm),xlab="X",main="residuos estudentizados vs. X\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5), pch=as.numeric(Técnico),col=as.numeric(Técnico),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
legend("top",legend=c(expression(paste("Técnico 1",sep=" ","(",sep="",X==+1,sep="",")")),
expression(paste("Técnico 2",sep=" ","(",sep="",X==-1,sep="",")"))),
pch=1:2,col=1:2,bg="cornsilk")
stripchart(rstandard(mrlm)~muestra,main="residuos estudentizados vs. muestra\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
#GRÁFICO DE RESIDUOS ESTUDENTIZADOS INTERNAMENTE
win.graph(width=8.5,height=6)
layout(rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6)))
plot(fitted(modeloanova),rstandard(modeloanova),main="residuos estudentizados vs. ajustados\nModelo ANOVA",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~Técnico, main="residuos estudentizados vs. Técnico\nModelo ANOVA",
xlab="Técnico",vertical=T, ylim=c(-2.5,2.5),pch=1:2,col=c(1:2),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~muestra,main="residuos estudentizados vs. muestra\nModelo ANOVA",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(fitted(mrlm),rstandard(mrlm),main="residuos estudentizados vs. ajustados\nMRLM",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(X,rstandard(mrlm),xlab="X",main="residuos estudentizados vs. X\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5), pch=as.numeric(Técnico),col=as.numeric(Técnico),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
legend("top",legend=c(expression(paste("Técnico 1",sep=" ","(",sep="",X==+1,sep="",")")),
expression(paste("Técnico 2",sep=" ","(",sep="",X==-1,sep="",")"))),
pch=1:2,col=1:2,bg="cornsilk")
stripchart(rstandard(mrlm)~muestra,main="residuos estudentizados vs. muestra\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
#GRÁFICO DE RESIDUOS ESTUDENTIZADOS INTERNAMENTE
win.graph(width=8.5,height=6)
layout(rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6)))
plot(fitted(modeloanova),rstandard(modeloanova),main="residuos estudentizados vs. ajustados\nModelo ANOVA",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~Técnico, main="residuos estudentizados vs. Técnico\nModelo ANOVA",
xlab="Técnico",vertical=T, ylim=c(-2.5,2.5),pch=1:2,col=c(1:2),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~muestra,main="residuos estudentizados vs. muestra\nModelo ANOVA",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(fitted(mrlm),rstandard(mrlm),main="residuos estudentizados vs. ajustados\nMRLM",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(X,rstandard(mrlm),xlab="X",main="residuos estudentizados vs. X\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5), pch=as.numeric(Técnico),col=as.numeric(Técnico),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
legend("top",legend=c(expression(paste("Técnico 1",sep=" ","(",sep="",X==+1,sep="",")")),
expression(paste("Técnico 2",sep=" ","(",sep="",X==-1,sep="",")"))),
pch=1:2,col=1:2,bg="cornsilk")
stripchart(rstandard(mrlm)~muestra,main="residuos estudentizados vs. muestra\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
#GRÁFICO DE RESIDUOS ESTUDENTIZADOS INTERNAMENTE
win.graph(width=8.5,height=6)
layout(rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6)))
plot(fitted(modeloanova),rstandard(modeloanova),main="residuos estudentizados vs. ajustados\nModelo ANOVA",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~Técnico, main="residuos estudentizados vs. Técnico\nModelo ANOVA",
xlab="Técnico",vertical=T, ylim=c(-2.5,2.5),pch=1:2,col=c(1:2),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~muestra,main="residuos estudentizados vs. muestra\nModelo ANOVA",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(fitted(mrlm),rstandard(mrlm),main="residuos estudentizados vs. ajustados\nMRLM",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(X,rstandard(mrlm),xlab="X",main="residuos estudentizados vs. X\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5), pch=as.numeric(Técnico),col=as.numeric(Técnico),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
legend("top",legend=c(expression(paste("Técnico 1",sep=" ","(",sep="",X==+1,sep="",")")),
expression(paste("Técnico 2",sep=" ","(",sep="",X==-1,sep="",")"))),
pch=1:2,col=1:2,bg="cornsilk")
stripchart(rstandard(mrlm)~muestra,main="residuos estudentizados vs. muestra\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
#GRÁFICO DE RESIDUOS ESTUDENTIZADOS INTERNAMENTE
win.graph(width=8.5,height=6)
layout(rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6)))
plot(fitted(modeloanova),rstandard(modeloanova),main="residuos estudentizados vs. ajustados\nModelo ANOVA",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~Técnico, main="residuos estudentizados vs. Técnico\nModelo ANOVA",
xlab="Técnico",vertical=T, ylim=c(-2.5,2.5),pch=1:2,col=c(1:2),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
stripchart(rstandard(modeloanova)~muestra,main="residuos estudentizados vs. muestra\nModelo ANOVA",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(fitted(mrlm),rstandard(mrlm),main="residuos estudentizados vs. ajustados\nMRLM",
ylim=c(-2.5,2.5),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
plot(X,rstandard(mrlm),xlab="X",main="residuos estudentizados vs. X\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5), pch=as.numeric(Técnico),col=as.numeric(Técnico),cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
legend("top",legend=c(expression(paste("Técnico 1",sep=" ","(",sep="",X==+1,sep="",")")),
expression(paste("Técnico 2",sep=" ","(",sep="",X==-1,sep="",")"))),
pch=1:2,col=1:2,bg="cornsilk")
stripchart(rstandard(mrlm)~muestra,main="residuos estudentizados vs. muestra\nModelo de efectos con MRLM",
ylim=c(-2.5,2.5),xlab="muestra",vertical=T,pch=1,cex=1.5)
abline(h=c(-2,0,2),lty=2,col=2)
knitr::opts_chunk$set(echo = TRUE)
ni=rep(4,5) #No. r?plicas por nivel
ni
#obseve que los renglones de datos corresponden a cada nivel desde 0 a 200, respectivamente
diseño2=data.frame(nitrato=factor(rep(c(0,50,100,150,200),times=ni)),nlechug=scan())
diseño2
diseño2
attach(diseño2)
#BOXPLOTS COMPARATIVOS
boxplot(nlechug~nitrato,boxwex = 0.5)
lines(1:5,mediasy2,col=2,lty=2,type="b",pch=19)
#CALCULANDO MEDIAS DE TRATAMIENTO PARA LUEGO USAR EN GR?FICA
mediasy2=sapply(split(nlechug,nitrato),mean)
mediasy2
#BOXPLOTS COMPARATIVOS
boxplot(nlechug~nitrato,boxwex = 0.5)
lines(1:5,mediasy2,col=2,lty=2,type="b",pch=19)
#AJUSTE MODELO DE ANALISIS DE VARIANZA
modelo2=aov(nlechug~nitrato)
modelo2
#OBTENIENDO TABLA ANOVA
anova(modelo2)
#OBTENIENDO MEDIAS ESTIMADAS POR NIVEL DEL FACTOR
model.tables(modelo2,type = "means",se=TRUE)
#Forma 2 de obtener las medias
lsmeans(modelo2,"nitrato")
?lsmeans
??lsmeans
library(gmodels)
library(multcomp)
library(daewr)
install.packages("daewr")
library(gmodels)
library(multcomp)
library(daewr)
library(car)
library(outliers)
install.packages("outliers")
library(gmodels)
library(multcomp)
library(daewr)
library(car)
library(outliers)
#Forma 2 de obtener las medias
lsmeans(modelo2,"nitrato")
#Forma 2 de obtener las medias
lsmeans(modelo2,"nitrato")
?lsmeans
library(gmodels)
library(multcomp)
library(daewr)
library(car)
library(outliers)
?lsmean
?lsmeans
#CREANDO FUNCION USUARIO mismediastratamientos()
mismediastratamientos=function(modeloanova,nivel=95){
MSE=anova(modeloanova)["Mean Sq"][2,]
df=anova(modeloanova)["Df"][2,]
ni=unlist(model.tables(modeloanova,type = "means")["n"])
alfa=1-nivel/100
alfa.med=(1-(nivel/100))/2
t=qt(alfa.med,df=df,lower.tail=F)
medias.tratam=unlist(model.tables(modeloanova,type = "means")["tables"])[-1]
interval=cbind(ni=ni,Medias=medias.tratam,LIC=medias.tratam-t*sqrt(MSE/ni),LSC=medias.tratam+t*sqrt(MSE/ni))
cat("Tabla de medias de tratamientos y sus I.C de",nivel,"%","\n")
cat("alfa","               ",alfa,"\n")
cat("grados de libertad    ",df,"\n")
cat("error cuadr?tico medio",MSE,"\n")
cat("valor cr?tico t       ",t,"\n","\n")
interval
}
mismediastratamientos(modeloanova = modelo2, nivel = 95)
112-157
142.6 -157
library(lsmeans)
library(lsmeans)
lsmeans(modelo2,~nitrato) #esta funci?n hace lo mismo que mismediastratamientos()
lsmeans(modelo2,"nitrato")
#ESTIMACI?N DE LOS EFECTOS PRINCIPALES:
model.tables(modelo2,type = "effects",se=TRUE)
#C?LCULO INDIVIDUAL DE EFECTOS, SUS TESTES T Y I.C DEL 95%:
efect.0=fit.contrast(modelo2,"nitrato",
rbind(":efecto 0"=c(4/5,-1/5,-1/5,-1/5,-1/5)),conf=0.95)
efect.50=fit.contrast(modelo2,"nitrato",
rbind(":efecto 50"=c(-1/5,4/5,-1/5,-1/5,-1/5)),conf=0.95)
efect.100=fit.contrast(modelo2,"nitrato",
rbind(":efecto 100"=c(-1/5,-1/5,4/5,-1/5,-1/5)),conf=0.95)
efect.150=fit.contrast(modelo2,"nitrato",
rbind(":efecto 150"=c(-1/5,-1/5,-1/5,4/5,-1/5)),conf=0.95)
efect.200=fit.contrast(modelo2,"nitrato",
rbind(":efecto 200"=c(-1/5,-1/5,-1/5,-1/5,4/5)),conf=0.95)
rbind(efect.0,efect.50,efect.100,efect.150,efect.200)
rbind(efect.0,efect.50,efect.100,efect.150,efect.200)
#C?LCULO INDIVIDUAL DE EFECTOS, SUS TESTES T Y I.C DEL 95%:
efect.0=fit.contrast(modelo2,"nitrato",
rbind(":efecto 0"=c(4/5,-1/5,-1/5,-1/5,-1/5)),conf=0.95)
efect.50=fit.contrast(modelo2,"nitrato",
rbind(":efecto 50"=c(-1/5,4/5,-1/5,-1/5,-1/5)),conf=0.95)
efect.100=fit.contrast(modelo2,"nitrato",
rbind(":efecto 100"=c(-1/5,-1/5,4/5,-1/5,-1/5)),conf=0.95)
efect.150=fit.contrast(modelo2,"nitrato",
rbind(":efecto 150"=c(-1/5,-1/5,-1/5,4/5,-1/5)),conf=0.95)
efect.200=fit.contrast(modelo2,"nitrato",
rbind(":efecto 200"=c(-1/5,-1/5,-1/5,-1/5,4/5)),conf=0.95)
rbind(efect.0,efect.50,efect.100,efect.150,efect.200)
rbind(efect.0,efect.50,efect.100,efect.150,efect.200)
#OTRA FORMA PARA C?LCULO INDIVIDUAL DE EFECTOS CON SUS INTERVALOS DE CONFIANZA DEL 95%:
contr0=rbind("efecto nitrato 0"= c(4/5,-1/5,-1/5,-1/5,-1/5))
contr50=rbind("efecto nitrato 50"= c(-1/5,4/5,-1/5,-1/5,-1/5))
contr100=rbind("efecto nitrato 100"= c(-1/5,-1/5,4/5,-1/5,-1/5))
contr150=rbind("efecto nitrato 150"= c(-1/5,-1/5,-1/5,4/5,-1/5))
contr200=rbind("efecto nitrato 200"= c(-1/5,-1/5,-1/5,-1/5,4/5))
rbind(confint(glht(modelo2,linfct=mcp(nitrato=contr0)))$confint,
confint(glht(modelo2,linfct=mcp(nitrato=contr50)))$confint,
confint(glht(modelo2,linfct=mcp(nitrato=contr100)))$confint,
confint(glht(modelo2,linfct=mcp(nitrato=contr150)))$confint,
confint(glht(modelo2,linfct=mcp(nitrato=contr200)))$confint)
#C?LCULO INDIVIDUAL DE EFECTOS, SUS TESTES T Y I.C DEL 95%:
efect.0=fit.contrast(modelo2,"nitrato",
rbind(":efecto 0"=c(4/5,-1/5,-1/5,-1/5,-1/5)),conf=0.95)
efect.50=fit.contrast(modelo2,"nitrato",
rbind(":efecto 50"=c(-1/5,4/5,-1/5,-1/5,-1/5)),conf=0.95)
efect.100=fit.contrast(modelo2,"nitrato",
rbind(":efecto 100"=c(-1/5,-1/5,4/5,-1/5,-1/5)),conf=0.95)
efect.150=fit.contrast(modelo2,"nitrato",
rbind(":efecto 150"=c(-1/5,-1/5,-1/5,4/5,-1/5)),conf=0.95)
efect.200=fit.contrast(modelo2,"nitrato",
rbind(":efecto 200"=c(-1/5,-1/5,-1/5,-1/5,4/5)),conf=0.95)
#OBTENIENDO GR?FICOS DE RESIDUOS INTERNAMENTE ESTUDENTIZADOS,
layout(rbind(c(1,1,2,2),c(0,3,3,0)))
stripchart(rstandard(modelo2)~nitrato,vertical=TRUE,ylim=c(-2.5,2.5),pch=1,cex=1,xlab="Lb N/acre")
abline(h=c(-2,0,2),lty=2)
plot(fitted(modelo2),rstandard(modelo2),ylim=c(-2.5,2.5))
abline(h=c(-2,0,2),lty=2)
qqnorm(rstandard(modelo2))
qqline(rstandard(modelo2),lty=2)
#TEST DE NORMALIDAD CON RESIDUOS INTERNAMENTE ESTUDENTIZADOS
shapiro.test(rstandard(modelo2))
#TESTES PARA HOMOGENEIDAD DE VARIANZA
bartlett.test(nlechug~nitrato)
leveneTest(nlechug~nitrato) #H0 iguales vs H1 diferentes
cochran.test(nlechug~nitrato,data=diseño2)
#Haciendo levene con test ANOVA
medianasy2=rep(sapply(split(nlechug,nitrato),median),each=4)
zij=abs(nlechug-medianasy2)
anova(aov(zij~nitrato))
