---
author: "Nombre Completo Autor"
date: "27/10/2017"
documentclass: book
forprint: true  # true: imprime a dos caras, false: libro digital
fontsize: 12pt # 10pt,11pt
geometry: margin = 2.5cm 
bibliography: ["bib/library.bib", "bib/paquetes.bib"]
# metodobib -> true: natbib (descomentar: citation_package: natbib) 
#           -> false: pandoc (comentar: citation_package: natbib)
metodobib: true
#natbib: plainnat, abbrvnat, unsrtnat
biblio-style: "plainnat"
#Método 2 (pandoc): descomente una línea de las 2 siguientes en caso de usarlo
csl: methods-in-ecology-and-evolution.csl      # no numera mejor en las citas
#csl: acm-sig-proceedings-long-author-list.csl  # numera peor en las citas
link-citations: yes
output: 
  pdf_document:
    keep_tex: no
    number_sections: yes
    citation_package: natbib  # comentado usa: pandoc-citeproc
    #toc: yes
    fig_caption: yes
    template: latex/plantilla_trabajos.tex
    includes:
      #before_body: portadas/latex_paginatitulo_modTFE.tex
      #in_header: latex/latex_preambulo.tex
      #after_body: latex/latex_antes_enddoc.tex
---



```{r include=FALSE}
knitr::opts_chunk$set(fig.path = 'figurasR/',
                      echo = FALSE, warning = FALSE, message = FALSE,
                      fig.pos="H",fig.align="center",out.width="95%",
                      cache=FALSE)

```


<!-- \setcounter{chapter}{2} -->
<!-- \setcounter{chapter}{2} escribir 2 para capítulo 3  -->
<!-- \pagenumbering{arabic} -->

\ifdefined\ifprincipal
\else
\setlength{\parindent}{1em}
\pagestyle{fancy}
\setcounter{tocdepth}{4}
\tableofcontents
<!-- \nocite{*} -->
\fi

\ifdefined\ifdoblecara
\fancyhead{}{}
\fancyhead[LE,RO]{\scriptsize\rightmark}
\fancyfoot[LO,RE]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[LE,RO]{\footnotesize\thepage}
\else
\fancyhead{}{}
\fancyhead[RO]{\scriptsize\rightmark}
\fancyfoot[LO]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[RO]{\footnotesize\thepage}
\fi
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}


# Resumen Descriptivo 3 (Ayuda)

## Lectura de datos

```{r,include=FALSE} 
uno <- read.table(file("datos/T11-7.DAT"))
datos <- uno
#library(data.table)
#library(pastecs)
```

A continuación se tiene un encbezado del conjunto de datos.

```{r echo = FALSE}
library(knitr)
library(kableExtra) 
head(datos,4) %>%
  kable(booktabs = TRUE,format = "latex",
    caption = "\\label{tabla01}Encabezado de Datos") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
    position = "center",full_width = FALSE)
```

$$
\underline{\overline{\mathbf{x}}}=\begin{bmatrix} 1 \\ 3\\ 5 \end{bmatrix}
$$


A contonuación se tiene el conjunto de datos completos.

```{r}
library(kableExtra) 
datos %>% 
  kable(booktabs = TRUE,format = "latex", longtable=TRUE,  caption = "\\label{tabla02}Conjunto de Datos Completo") %>%
  kable_styling(latex_options = c("striped", "condensed","repeat_header","hold_position"), 
   position = "center",full_width = FALSE,
   repeat_header_text = "Continuaci\\'on", 
   repeat_header_continued="Contin\\'ua en la siguiente p\\'agina")
```

##  Resúmen descripticvo de una Variable

**Estadisticos de tukey**: *Min, Q1, Median, Q3, Max*

```{r, echo=FALSE}
t(fivenum(datos[,1]) ) %>% 
  kable(booktabs = TRUE,format = "latex",  caption = "\\label{resumen-1}Algunas Estadísticas Resúmenes-1") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```

**Fución** *describe* **del paquete**: *Hmisc*

```{r echo = FALSE}
library(Hmisc)
resul1<-describe(datos[,1]) 
resul1 
```

**Fución** *stat.desc* **del paquete**: *pastecs*

```{r echo = FALSE}
library(pastecs)
stat.desc(datos[,1])    %>% 
  kable(booktabs = TRUE,format = "latex",  caption = "\\label{resumen-3}Algunas Estadísticas Resúmenes-3") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```

```{r, echo = FALSE}
library(pastecs)
tablita<-stat.desc(datos[,1:5])
tablita  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{resumen-4}Algunas Estadísticas Resúmenes-4 (Varias Vbles.)") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```

```{r, echo = FALSE}
library(data.table)
tablita2<-data.table(Estadisticos=rownames(tablita),tablita)
tablita2  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{resumen-5}Algunas Estadísticas Resúmenes-5 (Varias Vbles.)") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```


\newpage

**Fución** *describe* **del paquete**: *psych*


```{r echo = FALSE}
library(psych)
describe(datos[,1] ) %>% 
  kable(booktabs = TRUE,format = "latex", caption = "\\label{resumen-6}Algunas Estadísticas Resúmenes-6") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE, font_size = 7)
```

**Fución** *stargazer* **del paquete**: *stargazer*

```{r echo = FALSE , eval = FALSE}
library(stargazer)
stargazer(datos, header = FALSE, title = "Resumen de Datos con stargazer", digits=4)
```

\begin{table}[!htbp] \centering
\caption{Resumen de Datos con stargazer}
\label{}
\begin{tabular}{@{\extracolsep{5pt}}lccccccc}
\\[-1.8ex]\hline
\hline \\[-1.8ex]
Statistic & \multicolumn{1}{c}{N} & \multicolumn{1}{c}{Mean} & \multicolumn{1}{c}{St. Dev.} & \multicolumn{1}{c}{Min} & \multicolumn{1}{c}{Pctl(25)} & \multicolumn{1}{c}{Pctl(75)} & \multicolumn{1}{c}{Max} \\
\hline \\[-1.8ex]
V1 & 56 & 6.1804 & 2.4243 & 1.2000 & 3.9750 & 8.1000 & 11.0000 \\
V2 & 56 & 27.0464 & 11.6055 & 6 & 17.8 & 35 & 52 \\
V3 & 56 & 0.3414 & 0.3139 & 0.0000 & 0.0700 & 0.5000 & 1.5000 \\
V4 & 56 & 5.2991 & 1.3872 & 3.0600 & 4.2625 & 6.2050 & 9.2500 \\
V5 & 56 & 6.4336 & 3.1546 & 2.2200 & 3.4975 & 8.2850 & 13.0100 \\
\hline \\[-1.8ex]
\end{tabular}
\end{table}

## Resumen para cruce de vbles. cuantitativas con vbles. cualitativas

En este caso se utilzia el pauqete: *reporttools*

```{r echo = FALSE , eval = FALSE}
library(reporttools)          
titulo<-"Resumen de los Datos con reporttools (cruce de cuantixcuali)"
vbles<-datos[,1:4]
estadisticas<-list("mean","s",
                   "c$_{\\mathrm{v}}\\%$"=
                     function(x){
                       return((sd(x)/mean(x))*100)
                     },
                   "min","median","max","iqr","n", "na",
                   "skewness"=function(x) {
                     m3=mean((x-mean(x))^3)
                     skew=m3/(sd(x)^3)
                     return(skew)},
                   "kurtosis"=function(x) {
                     m4=mean((x-mean(x))^4)
                     kurt=m4/(sd(x)^4)
                     return(kurt)}
)
tableContinuous(vars = vbles, group = datos[,6], stats = estadisticas,cap=titulo,
                print.pval = "kruskal",longtable=FALSE)
```

\begin{table}[ht]
\centering
\begingroup\footnotesize
\begin{tabular}{llrrrrrrrrrrr}
\textbf{Variable} & \textbf{Levels} & $\mathbf{\bar{x}}$ & $\mathbf{s}$ & c$_{\mathrm{v}}\%$ & \textbf{Min} & $\mathbf{\widetilde{x}}$ & \textbf{Max} & \textbf{IQR} & $\mathbf{n}$ & \textbf{\#NA} & skewness & kurtosis \\
\hline
V1 & SubMuli & 4.4 & 2.0 & 44.2 & 1.2 & 4.2 & 8.4 & 1.1 & 11 & 0 & 0.6 & 2.6 \\
& Upper & 7.2 & 2.0 & 27.6 & 1.7 & 7.5 & 11.0 & 2.2 & 38 & 0 & -0.6 & 3.0 \\
& Wilhelm & 3.2 & 0.5 & 16.7 & 2.7 & 3.1 & 3.9 & 1.0 & 7 & 0 & 0.2 & 1.0 \\
\hline
$p< 0.0001$ & all & 6.2 & 2.4 & 39.2 & 1.2 & 6.2 & 11.0 & 4.1 & 56 & 0 & -0.1 & 1.9 \\
\hline
V2 & SubMuli & 33.1 & 10.8 & 32.5 & 12.0 & 35.0 & 47.0 & 7.5 & 11 & 0 & -0.6 & 2.3 \\
& Upper & 22.3 & 8.8 & 39.4 & 5.6 & 20.0 & 52.0 & 9.8 & 38 & 0 & 1.1 & 4.9 \\
& Wilhelm & 43.6 & 6.1 & 14.0 & 35.0 & 45.0 & 51.0 & 8.0 & 7 & 0 & -0.3 & 1.3 \\
\hline
$p< 0.0001$ & all & 27.0 & 11.6 & 42.9 & 5.6 & 25.0 & 52.0 & 17.2 & 56 & 0 & 0.5 & 2.2 \\
\hline
V3 & SubMuli & 0.2 & 0.2 & 107.6 & 0.0 & 0.1 & 0.5 & 0.2 & 11 & 0 & 0.9 & 2.1 \\
& Upper & 0.4 & 0.3 & 76.4 & 0.0 & 0.5 & 1.5 & 0.3 & 38 & 0 & 1.0 & 4.0 \\
& Wilhelm & 0.1 & 0.1 & 85.5 & 0.0 & 0.1 & 0.3 & 0.1 & 7 & 0 & 0.7 & 1.9 \\
\hline
$p= 0.0039$ & all & 0.3 & 0.3 & 91.9 & 0.0 & 0.3 & 1.5 & 0.4 & 56 & 0 & 1.3 & 4.8 \\
\hline
V4 & SubMuli & 6.6 & 1.3 & 19.3 & 5.1 & 6.2 & 9.2 & 1.6 & 11 & 0 & 0.8 & 2.3 \\
& Upper & 4.7 & 1.0 & 21.3 & 3.1 & 4.4 & 7.6 & 1.0 & 38 & 0 & 1.1 & 3.8 \\
& Wilhelm & 6.8 & 0.9 & 12.8 & 5.1 & 7.1 & 7.8 & 0.5 & 7 & 0 & -0.8 & 2.3 \\
\hline
$p< 0.0001$ & all & 5.3 & 1.4 & 26.2 & 3.1 & 5.0 & 9.2 & 1.9 & 56 & 0 & 0.7 & 2.7 \\
\hline
\end{tabular}
\endgroup
\caption{Resumen de los Datos con reporttools (cruce de cuantixcuali)}
\label{}
\end{table}


```{r echo = FALSE, eval=FALSE}
library(reporttools)                  
titulo<-"Resumen de los Datos con reporttools (cruce de cuantixcuali)"
vbles<-datos[,1:4]
estadisticas<-list("mean","s",
                   "c$_{\\mathrm{v}}\\%$"=
                     function(x){
                       return((sd(x)/mean(x))*100)
                     },
                   "min","median","max","iqr","n", "na",
                   "skewness"=function(x) {
                     m3=mean((x-mean(x))^3)
                     skew=m3/(sd(x)^3)
                     return(skew)},
                   "kurtosis"=function(x) {
                     m4=mean((x-mean(x))^4)
                     kurt=m4/(sd(x)^4)
                     return(kurt)}
)

#Cruece da vbles_cont con vbles_nominal
tableContinuous(vars = vbles, stats = estadisticas,cap=titulo,longtable=FALSE)
```

\begin{table}[ht]
\centering
\begingroup\footnotesize
\begin{tabular}{lrrrrrrrrrrr}
\textbf{Variable} & $\mathbf{\bar{x}}$ & $\mathbf{s}$ & c$_{\mathrm{v}}\%$ & \textbf{Min} & $\mathbf{\widetilde{x}}$ & \textbf{Max} & \textbf{IQR} & $\mathbf{n}$ & \textbf{\#NA} & skewness & kurtosis \\
\hline
V1 & 6.2 & 2.4 & 39.2 & 1.2 & 6.2 & 11.0 & 4.1 & 56 & 0 & -0.1 & 1.9 \\
V2 & 27.0 & 11.6 & 42.9 & 5.6 & 25.0 & 52.0 & 17.2 & 56 & 0 & 0.5 & 2.2 \\
V3 & 0.3 & 0.3 & 91.9 & 0.0 & 0.3 & 1.5 & 0.4 & 56 & 0 & 1.3 & 4.8 \\
V4 & 5.3 & 1.4 & 26.2 & 3.1 & 5.0 & 9.2 & 1.9 & 56 & 0 & 0.7 & 2.7 \\
\end{tabular}
\endgroup
\caption{Resumen de los Datos con reporttools (cruce de cuantixcuali)}
\label{}
\end{table}

## Cruce de Vbles. Cualitativas (cualixcuali)

```{r, echo=FALSE, eval=FALSE}
library(reporttools)        
cate<-factor(rep(c("A","B","C","D"),c(15,8,15,18)))
data2<-cbind(datos,cate)
# solo tabla de vbles_nominales
titulo2<-"Caracteristicas de las variables nominales"
tableNominal(vars = data2[,6:7],cap=titulo2,vertical = FALSE,font.size = "scriptsize",
             lab = "tab:nominal1",longtable = FALSE,cumsum = TRUE)
```

\begin{table}[h]
\centering
\begingroup
\begin{tabular}{llrrr}
\textbf{Variable} & \textbf{Levels} & $\mathbf{n}$ & $\mathbf{\%}$ & $\mathbf{\sum \%}$ \\
\hline
V6 & SubMuli & 11 & 19.6 & 19.6 \\
& Upper & 38 & 67.9 & 87.5 \\
& Wilhelm & 7 & 12.5 & 100.0 \\
\hline
& all & 56 & 100.0 & \\
\hline
\hline
cate & A & 15 & 26.8 & 26.8 \\
& B & 8 & 14.3 & 41.1 \\
& C & 15 & 26.8 & 67.9 \\
& D & 18 & 32.1 & 100.0 \\
\hline
& all & 56 & 100.0 & \\
\hline
\hline
\end{tabular}
\endgroup
\caption{Caracteristicas de las variables nominales}
\label{tab:nominal1}
\end{table}

\newpage

##  Gráficos con ggplot2

### Box-Plot

Se realiza el gráfico *box_plot* para las variables 6 y 1 del archivo de datos *datos* y se guarda dicha gráfica en la carpeta: *figuras.R* con el nombre: *graf1.png*.

```{r, echo=FALSE}
library(ggplot2)              
p1<-ggplot(datos, aes(datos[,6],datos[,1])) + geom_boxplot()
ggsave("figurasR/graf1.png",plot=p1)
```

Se carga al documento la gráfica de nombre: *graf1.png* de la carpeta: *figura.R*.

```{r echo = FALSE, out.width='70%', fig.align='center',fig.pos="H"}
include_graphics("figurasR/graf1.png")
```

### Mas opciones de Box-Plot

```{r, echo=FALSE}
library(ggplot2)
p2<-ggplot(datos, aes(datos[,6],datos[,1])) + geom_boxplot()+geom_jitter(width = 0.2)
ggsave("figurasR/graf2.png",plot=p2)
```

```{r echo = FALSE, out.width='70%', fig.align='center',fig.pos="H"}
include_graphics("figurasR/graf2.png")
```


```{r, echo=FALSE}
library(ggplot2)              
p3<-ggplot(datos, aes(datos[,6],datos[,1])) + geom_boxplot() + coord_flip()
ggsave("figurasR/graf3.png",plot=p3)
```

```{r echo = FALSE, out.width='70%', fig.align='center', fig.pos="H"}
include_graphics("figurasR/graf3.png")
```

### Box-Plot (con dos Cualitativas)

```{r, echo = FALSE}
library(ggplot2)              
cate<-factor(rep(c("A","B","C","D"),c(15,8,15,18)))
cate2<-factor(rep(c("SI","NO"),c(28,28)))
data2<-cbind(datos,cate,cate2)
p4<-ggplot(data2, aes(data2[,7],datos[,1])) + geom_boxplot(aes(colour = data2[,8])) 
ggsave("figurasR/graf4.png",plot=p4)
```

```{r echo = FALSE, out.width='70%', fig.align='center', fig.pos="H"}
include_graphics("figurasR/graf4.png")
```

```{r, echo = F}
library(ggplot2)              
cate<-factor(rep(c("A","B","C","D"),c(15,8,15,18)))
cate2<-factor(rep(c("SI","NO"),c(28,28)))
data2<-cbind(datos,cate,cate2)
p5<-ggplot(data2, aes(data2[,8],datos[,1])) + geom_boxplot(aes(colour = data2[,7])) 
ggsave("figurasR/graf5.png",plot=p5)
```

```{r echo = FALSE, out.width='70%', fig.align='center', fig.pos="H"}
include_graphics("figurasR/graf5.png")
```

## Obtención de Resumenes Descriptivos 

### Vector de Media Muestral

```{r, echo=F}
vector_medias <-apply(datos[,1:5],2,mean)
vector_medias  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{media}Vector de Medias Muestrales") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```

### Matriz de Varianzas-Covarianzas Muestral

```{r, echo=F}
var_cov <- cov(datos[,1:5]);
var_cov  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{var_cov}Matriz de Var-Cov Muestrales") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```

### Matriz de Correlación Muestral

```{r, echo=F}
correl <- cor(datos[,1:5]);
correl  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{correlacion}Matriz de  Correlación Muestrales") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```

## Gráfica de la Matriz de Correlación (o Matriz de Dispersión)

### Gráfico de la Matriz de Correlación por default

```{r echo=F, out.width='70%', fig.align='center', fig.pos="H"}
mat.cor <- correl
library(corrplot)
corrplot(mat.cor)
```

### metodo(forma), color-forma, color-etiquetas, inclinación-etiquetas

```{r echo=F, out.width='70%', fig.align='center', fig.pos="H"}
corrplot(mat.cor, method="shade", shade.col=NA, tl.col="black", tl.srt=45 )
```

### Con: addCoef.col, order

```{r echo=F, out.width='70%', fig.align='center', fig.pos="H"}
corrplot(mat.cor, method="shade", shade.col=NA,tl.col="red",
         tl.srt=45, addCoef.col="blue", addcolorlabel="no", order="AOE" )
```

```{r echo=F, out.width='70%', fig.align='center', fig.pos="H"}
datos4 <- read.table(file("datos/T8-6.DAT"),row.names = 1)
mat.cor4<-cor(datos4,method="pearson")
mat.cor4  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{correlacion}Matriz de  Correlación Muestrales") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

corrplot(mat.cor4,method="shade",shade.col=NA,tl.col="black",
         tl.srt=45,addCoef.col="green",addcolorlabel="no",order="AOE" )
```

### Con: addCoef.col,order, Gráfica Triagular

```{r echo=F}
corrplot(mat.cor4,method="shade",shade.col=NA,tl.col="black",tl.srt=45,
         addCoef.col="green",addcolorlabel="no",order="AOE",type="lower" )
```


```{r echo=F}
corrplot(mat.cor4,method="shade",shade.col=NA,tl.col="black",tl.srt=0,
         addCoef.col="green",addcolorlabel="no",order="AOE",type="upper" )
```

### Con: addCoef.col,order, Gráfica Triagular, sin Diagonal

```{r echo=F}
corrplot(mat.cor4,method="shade",shade.col=NA,tl.col="black",tl.srt=45,
         addCoef.col="green",addcolorlabel="no",order="AOE",type="upper",
         diag=F,addshade="all" )
```


```{r echo=F}
corrplot(mat.cor4,method="square",shade.col=NA,tl.col="black",tl.srt=45,
         addCoef.col="green",addcolorlabel="no",order="FPC",type="upper",
         diag=F,addshade="all" )
```


### Con: addCoef.col,order, Gráfica Triagular, sin Diagonal, con elipses

```{r echo=F}
corrplot(mat.cor4,method="ellipse",shade.col=NA,tl.col="black",tl.srt=45,
         addCoef.col="green",addcolorlabel="no",order="FPC",type="upper",
         diag=F,addshade="all" )
```


### Con: addCoef.col,order, Gráfica Triagular, sin Diagonal, con circulos

```{r echo=F}
corrplot(mat.cor4,method="circle",shade.col=NA,tl.col="black",tl.srt=45,
         addCoef.col="green",addcolorlabel="no",order="FPC",type="upper",
         diag=F,addshade="all" )
```

### Con: addCoef.col,order, Gráfica Triagular, sin Diagonal, con torta

```{r echo=F}
corrplot(mat.cor4,method="pie",shade.col=NA,tl.col="black",tl.srt=45,
         addCoef.col="green",addcolorlabel="no",order="FPC",type="upper",
         diag=F,addshade="all" )
```

## Para fundir la matriz de correlación (la matriz de corr en forma de un data.frmae con dos columnas y una tercera con las corrs)


```{r echo=F}
library(reshape2)
library(kableExtra) 
mat.melt4<-melt(mat.cor4)        
head(mat.melt4)  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{correlaciones-pares}Correlaciones por Pares") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

mat.melt4  %>% 
  kable(booktabs = TRUE,format = "latex",longtable=TRUE,  digits=4, caption = "\\label{correlaciones-pares2}Correlaciones Por Pares2") %>%
  kable_styling(latex_options = c("striped", "condensed","repeat_header","hold_position"), 
   position = "center",full_width = FALSE,
   repeat_header_text = "Continuaci\\'on", 
   repeat_header_continued="Contin\\'ua en la siguiente p\\'agina")
```

```{r echo=F, out.width='70%', fig.align='center', fig.pos="H"}
# gráfico de la matriz fundida
ggplot(data=mat.melt4, aes(x=Var1 , y=Var2, fill=value))+
  geom_tile()
```

\newpage

## Distancias

### Distancia de Mahalanobis

```{r echo=F}
x1<-c(11,12.5,13,13.7,14,5,15,8,8,5)
x2<-c(18.95,19.0,17.95,15.54,14.0,12.95,8.94,7.49,6.0,3.99)
x<-cbind(x1,x2)
#kable(x,caption="Datos")
t(x)  %>% 
  kable(booktabs = TRUE,format = "latex", digits=2, caption = "\\label{datos2}Datos") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

# Vector de medias
media<-apply(x,2,mean) 
media  %>% 
  kable(booktabs = TRUE,format = "latex", digits=2, caption = "\\label{media-datos2}Medias") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

#Matriz de var-cov
var<-var(x) 
var  %>% 
  kable(booktabs = TRUE,format = "latex", digits=4, caption = "\\label{var_cov}Matriz de Var-Cov") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

# Uso de la función: mahalanobis
distancias2<-mahalanobis(x,media,var)
#round(distancias2,3)    #distancias al cuadrado

t(distancias2)  %>% 
  kable(booktabs = TRUE,format = "latex", digits=3, caption = "\\label{dist-mahal}Dist. Mahalanobis (Al cuadrado)") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

#kable(round(dist_ord,3),caption="Dist-Orden")
dist_ord<-sort(distancias2)           # Dist. ordenadas
t(dist_ord)  %>% 
  kable(booktabs = TRUE,format = "latex", digits=3, caption = "\\label{dist-mahal-orden}Dist. Mahalanobis Ordenadas") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)


menores<-dist_ord<=qchisq(0.5,2) #Menores que el cuantil 0.5 de una chi2
menores

n_menores<-sum(menores)         # Número de Menores
n_menores
```

## Distancia Euclideana

```{r echo=F}
# method = "canberra" , "maximum") , "manhattan" , "binary" , "euclidean"
dist_eucli<-dist(x,method="euclidean",diag=FALSE,upper=FALSE)
dist_eucli<-as.matrix(dist_eucli)
dist_eucli  %>% 
  kable(booktabs = TRUE,format = "latex", digits=3, caption = "\\label{dist-euclideas}Dist. Euclideanas") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```

```{r echo=F}
# Para calular distancia a la Media
x<-rbind(x,apply(x, 2, mean))
dist_eucli_media<-dist(x,method="euclidean",diag=FALSE,upper=FALSE)
dist_eucli_media<-as.matrix(dist_eucli_media)
dist_eucli_media  %>% 
  kable(booktabs = TRUE,format = "latex", digits=3, caption = "\\label{dist-euclideas-media}Dist. Euclideanas a la Media") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

dist_eucli_media_vector<-dist_eucli_media[11,]
t(dist_eucli_media_vector)  %>% 
  kable(booktabs = TRUE,format = "latex", digits=3, caption = "\\label{dist-euclideas-media2}Dist. Euclideanas a la Media2") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)

diast1<-cbind(dist_eucli_media_vector,distancias2)
diast1 %>% 
  kable(booktabs = TRUE,format = "latex", digits=3, caption = "\\label{dist-euclideas-media3}Dist. Euclideanas y de Mahalanobis a la Media") %>%
  kable_styling(latex_options = c("striped", "condensed","hold_position"), 
   position = "center",full_width = FALSE)
```




