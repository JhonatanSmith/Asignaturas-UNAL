---
title: "1_Graficas_superf_NM"
author: "Raúl Alberto Pérez"
date: "22/4/2022"
output: pdf_document
---

````{r include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
````

# Gráficas Varias de Superficies Normales $2$-Variada

````{r echo=TRUE}
library(MASS)
library(mvtnorm)
library(MVN)
library(clusterGeneration)  
### package clusterGeneration, para generar MSDP ###
````

## Primera Vista

````{r echo=TRUE}
# datos para grafica1
media1 <- c(0, 0)
sigma1<-genPositiveDefMat("eigen",dim=2)$Sigma      

x <- seq(from=-12, to=12, length.out=60)
y <- seq(from=-12, to=12, length.out=60)

fun1 <- function(x, y) dmvnorm(c(x, y), mean=media1, 
                               sigma=sigma1)
fun1 <- Vectorize(fun1)
z1 <- outer(x, y, fun1)

# datos para grafica2
media2 <- c(0, 0)
sigma2<-genPositiveDefMat("eigen",dim=2)$Sigma      

fun2 <- function(x, y) dmvnorm(c(x, y), mean=media2, 
                               sigma=sigma2)
fun2 <- Vectorize(fun2)
z2 <- outer(x, y, fun2)

# datos para grafica3
media3 <- c(0, 0)
sigma3<-genPositiveDefMat("eigen",dim=2)$Sigma      

fun3 <- function(x, y) dmvnorm(c(x, y), mean=media3, 
                               sigma=sigma3)
fun3 <- Vectorize(fun3)
z3 <- outer(x, y, fun3)

# realización de las 3-gráficas
par(mfrow=c(1, 3), mar=c(1, 1, 1, 1))
persp(x, y, z1, theta=-10, phi=20, expand=0.8, axes=FALSE,box=F)
persp(x, y, z2, theta=-10, phi=20, expand=0.8, axes=FALSE,box=F)
persp(x, y, z3, theta=-10, phi=20, expand=0.8, axes=FALSE,box=F)
````

## Varianza Generalizadas (detrminnates de $\boldsymbol{S}$) y Máximos Obtenidos para cada caso.

$$
\boldsymbol{S1}=`r det(sigma1)` \ \ \ , \ \ \ 
\boldsymbol{S1}=`r det(sigma2)` \ \ \ \text{y} \ \ \ 
\boldsymbol{S1}=`r det(sigma3)` 
$$

$$
L_1(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_1,\boldsymbol{S}_1) = `r max(z1)` \ \ \ , \ \ \ 
L_2(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_2,\boldsymbol{S}_2) = `r max(z2)` \ \ \ \text{y} \ \ \ 
L_3(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_3,\boldsymbol{S}_3) = `r max(z3)` \ \ \ , \ \ \ 
$$

# Segunda Vista

````{r echo=TRUE}
## datos para primera gráfica
media1 <- c(0, 0)
sigma1 <- matrix(c(1, 0, 0, 1), ncol=2)

x <- seq(from=-12, to=12, length.out=60)
y <- seq(from=-12, to=12, length.out=60)

fun1 <- function(x, y) dmvnorm(c(x, y), mean=media1, 
                               sigma=sigma1)
fun1 <- Vectorize(fun1)
z1 <- outer(x, y, fun1)

## datos para segunda gráfica
media2 <- c(0, 0)
sigma2 <- matrix(c(2, 0, 0, 2), ncol=2)

fun2 <- function(x, y) dmvnorm(c(x, y), mean=media2, 
                               sigma=sigma2)
fun2 <- Vectorize(fun2)
z2 <- outer(x, y, fun2)

## datos para tercera gráfica
media3 <- c(0, 0)
sigma3 <- matrix(c(3, 0, 0, 3), ncol=2)

fun3 <- function(x, y) dmvnorm(c(x, y), mean=media3, 
                               sigma=sigma3)
fun3 <- Vectorize(fun3)
z3 <- outer(x, y, fun3)

# realización de las 3-gráficas
par(mfrow=c(1, 3), mar=c(1, 1, 1, 1))
persp(x, y, z1, theta=-10, phi=20, expand=0.8, axes=FALSE,box=F)
persp(x, y, z2, theta=-10, phi=20, expand=0.8, axes=FALSE,box=F)
persp(x, y, z3, theta=-10, phi=20, expand=0.8, axes=FALSE,box=F)
````

## Varianza Generalizadas (detrminnates de $\boldsymbol{S}$) y Máximos Obtenidos para cada caso.

$$
\boldsymbol{S1}=`r det(sigma1)` \ \ \ , \ \ \ 
\boldsymbol{S1}=`r det(sigma2)` \ \ \ \text{y} \ \ \ 
\boldsymbol{S1}=`r det(sigma3)` 
$$

$$
L_1(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_1,\boldsymbol{S}_1) = `r max(z1)` \ \ \ , \ \ \ 
L_2(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_2,\boldsymbol{S}_2) = `r max(z2)` \ \ \ \text{y} \ \ \ 
L_3(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_3,\boldsymbol{S}_3) = `r max(z3)` \ \ \ , \ \ \ 
$$

# Tercera Vista


````{r echo=TRUE}
x<-seq(-12,12,len=50)
y<-seq(-13,12,len=50)

normal.bivariada<-function(x,y,rho,mu1,sigma1,mu2,sigma2)
{
  1/(2*pi*sigma1*sigma2*sqrt(1-rho^2))*exp(-1/(2*(1-rho^2))*
  (((x-mu1)/sigma1)^2-2*rho*((x-mu1)/sigma1)*
     ((y-mu2)/sigma2)+
((y-mu2)/sigma2)^2))
}

## datos primera gráfica
f1<-outer(x,y,normal.bivariada,rho=0,mu1=0,mu2=0,
          sigma1=1,sigma2=1)

sigma1 <- matrix(c(1, 0, 0, 1), ncol=2)

## datos segunda gráfica
f2<-outer(x,y,normal.bivariada,rho=0,mu1=0,mu2=0,
          sigma1=2,sigma2=2)

sigma3 <- matrix(c(2, 0, 0, 2), ncol=2)

## datos tercera gráfica
f3<-outer(x,y,normal.bivariada,rho=0,mu1=0,mu2=0,
          sigma1=3,sigma2=3)

sigma3 <- matrix(c(3, 0, 0, 3), ncol=2)

### realización de las tres Grafias
library(latex2exp)

nf<-layout(matrix(c(1,2,3),ncol=3,byrow=T),
            widths=c(rep(12,4)),heights=c(rep(12,2)),
           respect=T)

par( mar=c(1,1,1,1) )
persp(x,y,f1,theta = 30, phi = 30, col = "lightblue",
      xlab = "X", ylab = "Y", zlab = "Z",
  main = TeX('$\\rho=0$, \ $\\mu_1=0$, \ $\\mu_2=0$, 
             \ $\\sigma_1=1$, \ $\\sigma_2=1$') , 
  cex.main=0.8)

persp(x,y,f2,theta = 30, phi = 30, col = "lightblue",
      xlab = "X", ylab = "Y", zlab = "Z",
      main = TeX('$\\rho=0$, \ $\\mu_1=0$, \ $\\mu_2=0$, 
             \ $\\sigma_1=2$, \ $\\sigma_2=2$') , 
      cex.main=0.8)

persp(x,y,f3,theta = 30, phi = 30, col = "lightblue",
      xlab = "X", ylab = "Y", zlab = "Z",
      main = TeX('$\\rho=0$, \ $\\mu_1=0$, \ $\\mu_2=0$, 
             \ $\\sigma_1=3$, \ $\\sigma_2=3$') , 
      cex.main=0.8)
````      

## Varianza Generalizadas (detrminnates de $\boldsymbol{S}$) y Máximos Obtenidos para cada caso.

$$
\boldsymbol{S1}=`r det(sigma1)` \ \ \ , \ \ \ 
\boldsymbol{S1}=`r det(sigma2)` \ \ \ \text{y} \ \ \ 
\boldsymbol{S1}=`r det(sigma3)` 
$$

$$
L_1(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_1,\boldsymbol{S}_1) = `r max(z1)` \ \ \ , \ \ \ 
L_2(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_2,\boldsymbol{S}_2) = `r max(z2)` \ \ \ \text{y} \ \ \ 
L_3(\hat{\underline{\mu}},\hat{\boldsymbol{\Sigma}})=L(\underline{\overline{x}}_3,\boldsymbol{S}_3) = `r max(z3)` \ \ \ , \ \ \ 
$$




