---
title: "Get Started"
output: flexdashboard::flex_dashboard
---

```{r setup, include = F, message = F}
if(!require(pacman)){install.packages("pacman"); library(pacman)}
pacman::p_load("tidyverse", "ggplot2", "pBrackets", "knitr", "HH", "car", "rgl","latex2exp","magrittr","ICSNP","rrcov",
              "Hotelling", "sampling","biotools","flexdashboard","MASS","mvtnorm","MVN")
source("funciones.R", local = knitr::knit_global())
source("Functions.R", local = knitr::knit_global())
```

**PH $\underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$\ ; \    $\boldsymbol{\Sigma}_1=\boldsymbol{\Sigma}_2$**
=========================================

Column 1 pag 1
--------------------------------------------------

### **PH para\ \  $H_0\ : \ \ \underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$\ \ o para \ \  $\underline{\mu}_1=\underline{\mu}_2$ si $\underline{\mu}_0=\underline{0}$\ ; \ \ con: \ \  $\boldsymbol{\Sigma}_1=\boldsymbol{\Sigma}_2=\boldsymbol{\Sigma}$-Desconocida**

```{r}
alfa<-c(0.05)

mu1=c(0,0)
sigma1<-matrix(c(4,-3,-3,4),ncol=2)
mu2=c(1,2)
sigma2<-matrix(c(4,2,2,4),ncol=2)
#datos1<-round(mvrnorm(n=100, mu1,sigma1),3)
#datos2<-round(mvrnorm(n=100, mu2,sigma2),3)
#datos6<-read.table("G:\\Mi unidad\\1_A_A_CURSOS_UNAL\\1_MULTIVARIADO\\2022_I\\tableros_IAM\\datos\\datos6.txt",header=TRUE)
datos6 <- read.table("datos6.txt",header=TRUE)
datos6$Grupos %<>% as.factor()
grupo1<-datos6 %>% filter(Grupos=="1")
grupo2<-datos6 %>% filter(Grupos=="2")
grupo3<-datos6 %>% filter(Grupos=="3")
grupo1<-grupo1[,1:3]
grupo2<-grupo3[,1:3]
mu_0=c(0,0,0)
xbar<-apply(grupo1, 2, mean)
xvar<-var(grupo1)
ybar<-apply(grupo2, 2, mean)
yvar<-var(grupo2)
```

**Datos Generados de una Normal Bivariada con parámetros**:
$$
\underline{\mu}_1=\begin{bmatrix}\mu_1 \\ \mu_2 \end{bmatrix}=\begin{bmatrix} `r mu1[1]` \\ `r mu1[2]`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{\Sigma}_1=\begin{bmatrix}\sigma_{11} & \sigma_{12} \\ \sigma_{21} & \sigma_{22} \end{bmatrix}=\begin{bmatrix} `r sigma1[1,1]` & `r sigma1[1,2]` \\ `r sigma1[2,1]` & `r sigma1[2,2]` \end{bmatrix} 
$$
$$
\underline{\mu}_2=\begin{bmatrix}\mu_1 \\ \mu_2 \end{bmatrix}=\begin{bmatrix} `r mu2[1]` \\ `r mu2[2]`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{\Sigma}_2=\begin{bmatrix}\sigma_{11} & \sigma_{12} \\ \sigma_{21} & \sigma_{22} \end{bmatrix}=\begin{bmatrix} `r sigma2[1,1]` & `r sigma2[1,2]` \\ `r sigma2[2,1]` & `r sigma2[2,2]` \end{bmatrix} 
$$

**Las estimaciones muestrales de los parámetros son**:
$$
\underline{\overline{x}}_1=\begin{bmatrix} \overline{x}_1 \\ \overline{x}_2  \end{bmatrix}= \begin{bmatrix} `r  round(xbar[1],3)` \\ `r round(xbar[2],3)`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{S}_1=\begin{bmatrix} s_{11} & s_{12} \\ s_{21} & s_{22} \end{bmatrix} =  \begin{bmatrix} `r round(xvar[1,1],3)` & `r round(xvar[1,2],3)` \\ `r round(xvar[2,1],3)` & `r round(xvar[2,2],3)` \end{bmatrix} 
$$
$$
\underline{\overline{x}}_2=\begin{bmatrix} \overline{x}_1 \\ \overline{x}_2  \end{bmatrix}= \begin{bmatrix} `r  round(ybar[1],3)` \\ `r round(ybar[2],3)`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{S}_2=\begin{bmatrix} s_{11} & s_{12} \\ s_{21} & s_{22} \end{bmatrix} =  \begin{bmatrix} `r round(yvar[1,1],3)` & `r round(yvar[1,2],3)` \\ `r round(yvar[2,1],3)` & `r round(yvar[2,2],3)` \end{bmatrix} 
$$
**Se desea realizar la siguiente prueba de hipótesis**:
$$ 
\begin{cases}
H_0 \ : \  \underline{\mu}_1= \underline{\mu}_2\\ \\ 
H_a \ : \  \underline{\mu}_1\neq \underline{\mu}_2 
\end{cases}
\ \ \ \ \Longleftrightarrow \ \ \  
\begin{cases}
H_0 \ : \  \underline{\mu}_1- \underline{\mu}_2=\underline{0}\\ \\ 
H_a \ : \  \underline{\mu}_1- \underline{\mu}_2 \neq \underline{0}
\end{cases}
$$
Para $\boldsymbol{\Sigma}_1=\boldsymbol{\Sigma}_2=\boldsymbol{\Sigma}$-Desconocida, se usa como estimador de $\boldsymbol{\Sigma}$ a la varianza ponderada dada por:
$$
S_p= \hat{\boldsymbol{\Sigma}}=\frac{(n-1)S_1+(m-1)S_2}{n+m-2},
$$
**El estadístico de prueba es**:
$$
\hspace{-1.0cm} T^2=\frac{nm}{n+m} \bigl(\overline{\underline{\boldsymbol{x}}}_1-
\overline{\underline{\boldsymbol{x}}}_2 \bigr)^t
\boldsymbol{S}_p^{-1}
\bigl(\overline{\underline{\boldsymbol{x}}}_1-
\overline{\underline{\boldsymbol{x}}}_2 \bigr)
 \sim kF \ \ , \ \ \text{con:} \ \ \ k=\frac{(n+m-2)p}{n+m-p-1}
$$
**Rechazamos $H_0$ si**:
$$
T_0^2 > kF=\frac{(n+m-2)p}{n+m-p-1}F_{\alpha\ : \  p \ , \ n+m-p-1} \ \ \ \ , \ \  \text{ó equivalentemente}
$$
$$
\text{Rechazamos} \ \ \  H_0 \ \ \  \text{si}: \ \ \ F_0=\frac{1}{k}T_0^2 > F_{tabla}=F_{\alpha\ : \  p \ , \ n+m-p-1}
$$



Column 2 pag 1 
--------------------------------------------------

### **Prueba de Hipótesis: $H_0 \ : \ \underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$**

```{r echo = TRUE}
res2p<-HT2_sigmas_iguales(grupo1,grupo2,mu_0,0.05)
kable(res2p)
```

### **Utilizando las funciones ``HotellingsT2``, ``hotelling.test`` y ``T2.test``**

```{r echo = TRUE, message=FALSE}
res_1<-HotellingsT2(grupo1,grupo2,mu_0)
res_1
#resT2<-T2.test(grupo1,grupo2)
#resT2
#resh<-hotelling.test(grupo1,grupo2)
#resh
```

**PH $\underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$\ ; \    $\boldsymbol{\Sigma}_1\neq\boldsymbol{\Sigma}_2$**
=========================================

Column 1 pag 2
--------------------------------------------------

### **PH para: $H_0 \ : \ \underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$\ \ \ o para: $\underline{\mu}_1=\underline{\mu}_2$ si $\underline{\mu}_0=\underline{0}$, \ \ con: \ \  $\boldsymbol{\Sigma}_1\neq\boldsymbol{\Sigma}_2$**

**Las estimaciones muestrales de los parámetros son**:
$$
\underline{\overline{x}}_1=\begin{bmatrix} \overline{x}_1 \\ \overline{x}_2  \end{bmatrix}= \begin{bmatrix} `r  round(xbar[1],3)` \\ `r round(xbar[2],3)`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{S}_1=\begin{bmatrix} s_{11} & s_{12} \\ s_{21} & s_{22} \end{bmatrix} =  \begin{bmatrix} `r round(xvar[1,1],3)` & `r round(xvar[1,2],3)` \\ `r round(xvar[2,1],3)` & `r round(xvar[2,2],3)` \end{bmatrix} 
$$
$$
\underline{\overline{x}}_2=\begin{bmatrix} \overline{x}_1 \\ \overline{x}_2  \end{bmatrix}= \begin{bmatrix} `r  round(ybar[1],3)` \\ `r round(ybar[2],3)`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{S}_2=\begin{bmatrix} s_{11} & s_{12} \\ s_{21} & s_{22} \end{bmatrix} =  \begin{bmatrix} `r round(yvar[1,1],3)` & `r round(yvar[1,2],3)` \\ `r round(yvar[2,1],3)` & `r round(yvar[2,2],3)` \end{bmatrix} 
$$
**Se desea realizar la siguiente prueba de hipótesis**:
$$ 
\begin{cases}
H_0 \ : \  \underline{\mu}_1= \underline{\mu}_2\\ \\ 
H_a \ : \  \underline{\mu}_1\neq \underline{\mu}_2 
\end{cases}
\ \ \ \ \Longleftrightarrow \ \ \  
\begin{cases}
H_0 \ : \  \underline{\mu}_1- \underline{\mu}_2=\underline{0}\\ \\ 
H_a \ : \  \underline{\mu}_1- \underline{\mu}_2 \neq \underline{0}
\end{cases}
$$
**El estadístico de prueba es**:
$$
T^2= \bigl(\overline{\underline{\boldsymbol{x}}}_1-
\overline{\underline{\boldsymbol{x}}}_2 \bigr)^t
\left[\frac{S_1}{n}+\frac{S_2}{m} \right]^{-1}
\bigl(\overline{\underline{\boldsymbol{x}}}_1-
\overline{\underline{\boldsymbol{x}}}_2 \bigr)
\sim kF \ \ , \ \ \text{con} \ \ \ k=\frac{vp}{v-p+1}  
$$
**Aproximación de: Nel and Van Der Merwe-1986 para $v$**
$$
v=\frac{tr(S_e)+\bigl[tr(S_e)\bigr]^2}{\sum_{i=1}^2 \frac{1}{n_i-1}\biggl\{  tr(V_i)+[tr(V_i)]^2\biggr\}  }
$$
**Aproximación de: Krishnamoorty and Yu-2004 para $v$**
$$
v=\frac{p+p^2}{\frac{1}{n_1}\biggl\{  tr\bigl[(V_1S_e^{-1})^2\bigr]+[tr(V_1S_e^{-1})]^2 \biggr\} +\frac{1}{n_2} \biggl\{tr\bigl[(V_2S_e^{-1})^2\bigr]+[tr(V_2S_e^{-1})]^2\biggr\}  }
$$
$$
S_e=V_1+V_2=\frac{S_1}{n}+\frac{S_2}{m}.
$$
**Rechazamos** $H_0$ si: \ \ \  $T_0^2 > kF \ \ \ \  \text{ó}\ \  \ \ \  F_0=\frac{1}{k}T_0^2>F_{tabla}=F_{1-\alpha\ ;\ p \ ; \ v-p+1}$


Column 2 pag 2 
--------------------------------------------------

### **Prueba de Hipótesis: $H_0 \ : \ \underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$. Aproximación de: Nel and Van Der Merwe-1986**

```{r echo = TRUE}
res_sigmasdif<-HT2_sigmas_diferentes(grupo1,grupo2,mu_0,0.05)
kable(res_sigmasdif)
```

### **Prueba de Hipótesis: $H_0 \ : \ \underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$. Aproximación de: Krishnamoorty and Yu-2004**

```{r echo = F}
res_sigmasdif1<-HT2_sigmas_diferentes_texto_guia(grupo1,grupo2,mu_0,0.05)
kable(res_sigmasdif1)
```


**PH $\underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$\ ; \  $n$-Grande**
=========================================

Column 1 pag 1
--------------------------------------------------

### **PH $\underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$\ ; \  $n$-Grande**

**Las estimaciones muestrales de los parámetros son**:
$$
\underline{\overline{x}}_1=\begin{bmatrix} \overline{x}_1 \\ \overline{x}_2  \end{bmatrix}= \begin{bmatrix} `r  round(xbar[1],3)` \\ `r round(xbar[2],3)`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{S}_1=\begin{bmatrix} s_{11} & s_{12} \\ s_{21} & s_{22} \end{bmatrix} =  \begin{bmatrix} `r round(xvar[1,1],3)` & `r round(xvar[1,2],3)` \\ `r round(xvar[2,1],3)` & `r round(xvar[2,2],3)` \end{bmatrix} 
$$
$$
\underline{\overline{x}}_2=\begin{bmatrix} \overline{x}_1 \\ \overline{x}_2  \end{bmatrix}= \begin{bmatrix} `r  round(ybar[1],3)` \\ `r round(ybar[2],3)`  \end{bmatrix} \ \ \ \ \ y \ \ \ \ \boldsymbol{S}_2=\begin{bmatrix} s_{11} & s_{12} \\ s_{21} & s_{22} \end{bmatrix} =  \begin{bmatrix} `r round(yvar[1,1],3)` & `r round(yvar[1,2],3)` \\ `r round(yvar[2,1],3)` & `r round(yvar[2,2],3)` \end{bmatrix} 
$$

**Se desea realizar la siguiente prueba de hipótesis**:
$$ 
\begin{cases}
H_0 \ : \  \underline{\mu}_1= \underline{\mu}_2\\ \\ 
H_a \ : \  \underline{\mu}_1\neq \underline{\mu}_2 
\end{cases}
\ \ \ \ \Longleftrightarrow \ \ \  
\begin{cases}
H_0 \ : \  \underline{\mu}_1- \underline{\mu}_2=\underline{0}\\ \\ 
H_a \ : \  \underline{\mu}_1- \underline{\mu}_2 \neq \underline{0}
\end{cases}
$$
**Si $\boldsymbol{\Sigma}_1=\boldsymbol{\Sigma}_2=\boldsymbol{\Sigma}$-Desconocida se utiliza el estadístico de prueba es**:
$$
\chi_0^2=\frac{nm}{n+m}\bigl(\overline{\underline{\boldsymbol{x}}}_1-\overline{\underline{\boldsymbol{x}}}_2\bigr)^t
\boldsymbol{S}_p^{-1}
\bigl(\overline{\underline{\boldsymbol{x}}}_1-\overline{\underline{\boldsymbol{x}}}_2\bigr)
\sim \chi_{p}^2
$$
$$
\text{con:}\ \ \hat{\boldsymbol{\Sigma}}=S_p=\frac{(n-1)S_1+(m-1)S_2}{n+m-2},
$$
**Si $\boldsymbol{\Sigma}_1\neq\boldsymbol{\Sigma}_2$-Desconocidas se utiliza**:
$$
\chi_0^2=\bigl(\overline{\underline{\boldsymbol{x}}}_1-\overline{\underline{\boldsymbol{x}}}_2\bigr)^t
\boldsymbol{S}_e^{-1}
\bigl(\overline{\underline{\boldsymbol{x}}}_1-\overline{\underline{\boldsymbol{x}}}_2\bigr)
\sim \chi_{p}^2
$$
$$
\text{con}:\ \ \ S_e=\frac{S_1}{n}+\frac{S_2}{m}
$$

**Rechazamos** $H_0$ si $\chi_0^2 > \chi_{\alpha,p}$.


Column 2 pag 1 
--------------------------------------------------

### **Prueba de Hipótesis: $H_0 \ : \ \underline{\mu}_1-\underline{\mu}_2=\underline{\mu}_0$ $n$-Grande**

```{r echo = TRUE}
res2p_ngrande<-HT2_sigmas_iguales_ngrande(grupo1,grupo2,mu_0,0.05)
kable(res2p_ngrande)
```

### **Utilizando la función ``HotellingsT2``**


```{r echo = TRUE}
res_1A<-HotellingsT2(grupo1,grupo2,mu_0,test="chi")
res_1A
```




